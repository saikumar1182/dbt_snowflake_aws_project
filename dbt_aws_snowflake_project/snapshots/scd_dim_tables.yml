snapshots:
  - name: dim_bookings
    relation: ref('bookings')
    config:
      database: AIRBNB
      schema: gold_layer
      unique_key: BOOKING_ID
      strategy: timestamp
      updated_at: BOOKING_CREATED_AT
      dbt_valid_to_current: "to_date('9999-12-31')"

  - name: dim_hosts
    relation: ref('hosts')
    config:
      database: AIRBNB
      schema: gold_layer
      unique_key: HOST_ID
      strategy: timestamp
      updated_at: HOSTS_CREATED_AT
      dbt_valid_to_current: "to_date('9999-12-31')"

  - name: dim_listings
    relation: ref('listings')
    config:
      database: AIRBNB
      schema: gold_layer
      unique_key: LISTING_ID
      strategy: timestamp
      updated_at: LISTINGS_CREATED_AT
      dbt_valid_to_current: "to_date('9999-12-31')"